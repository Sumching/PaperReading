# COCO-GAN: Generation by Parts via Conditional Coordinating

# 通过条件坐标的部分图像生成 

![image-20191217144830634](/home/chenshen/.config/Typora/typora-user-images/image-20191217144830634.png)



### 目的：学习与latentcode流形正交的 坐标流形

###  创新点：

**1. 生成图片看起来真实平滑。**小块图像拼接以后再给判别器 D 训练能把多个相邻小块图像之间的连续性和一致性也考虑到对抗损失当中，使得生成器 G 生成拼接出来的大块图像看起来不奇怪，很平滑真实，足以迷惑判别器 D；

**2. 计算高效，低内存占用。**因为内部的分治算法可以有效降低内存占用，而多个小块图像是相互独立地生成的，不依赖于其他块信息，而共享同样的潜在向量，所以具有高并行性，而且计算只用到了局部的视图；

**3. 创新性的应用。**可以生成比训练样本更大的图像即**超边界生成**，只需要把学习到的坐标流形往外推算，而这是其他 GAN 都做不到的，是 COCO-GAN 独有的，还有类似的**小块引导生成，全景图生成**等新颖特别的应用。

COCO-GAN 使用了**三项损失**来进行训练 ：

\1. Wasserstein 对抗损失  ，使用 Wasserstein 距离，其中 ψ 表示裁剪函数，φ 表示拼接函数，将真实图像 x 根据坐标条件裁剪出大块图像，将潜在的特征向量 z 根据坐标条件 C" 输入到生成器 G，生成多个小块图像 S"，在经过 φ函数拼接出大块的假图像 s'，一方面迫使判别器 D 学会区分真实的大块图像 x' 和大块的假图像 s'，另一方面鼓励生成器 G 生成拼接以后看起来真实的假图像来尽可能迷惑判别器 D：

![img](http://5b0988e595225.cdn.sohucs.com/images/20191003/77eb5baf197d4a99878050309a23b645.png)

\2. 梯度惩罚：

![img](http://5b0988e595225.cdn.sohucs.com/images/20191003/a66e17bbc98c41019acd4c143bb64652.png)

\3. 空间一致性损失，和 ACGAN 的损失相似，这里稍有不同的是 ACGAN 处理多个不同离散的标签的分类问题，一般使用交叉熵。而 COCO-GAN 处理的坐标位置信息是连续的，因此作者使用了 L2 损失，从而可以更好的拉近真实的大块图像的位置分布和判别器估计的位置分布：

![img](http://5b0988e595225.cdn.sohucs.com/images/20191003/b4cdf3c405cf4cb882f453b2ad51c892.png)

前两项损失是 WGAN-GP 的损失很常见，最后一项空间一致性损失目标是减少真实的大块图像坐标位置 c' 和判别器 D 辅助估计预测的坐标位置的。COCO-GAN 中判别器 D 和生成器 G 的**损失函数**如下：

![img](http://5b0988e595225.cdn.sohucs.com/images/20191003/1002fa51879e4be78d62d20e36239ba3.png)

